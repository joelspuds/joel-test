{% set loggedOut = false %}
{% set isAdminUser = false %}
{% set showExternalNav = true %}
{% set signInLink = '#' %}
{% set hideAccountLinks = true %}
{% set activeNavItem = 'reviews' %}
{% set applicationsLink = '#' %}
{% set homeLink = '/prototypes/peer-review-external/user-home' %}
{% set reviewsLink = '/prototypes/peer-review-external/user-reviews-complete' %}
{% set awardsSetupLinkHide = true %}
{% set awardsLinkHide = true %}
{% set signOutLink = '#' %}
{% set altProfilePagelink = '#' %}

{% extends 'layouts/bulma-ufs.layout.njk' %}
{% set navType = 'NOTadmin' %}
{% set pageTitle = 'Application review' + GLOBAL_TAG_TITLE_SUFFIX %}
{% set backLinkContents =  [{url:'/prototypes/peer-review-external/user-reviews-complete', text:'Back to all reviews'}] %}

{% set review = review if review %}
{% set rating = rating if rating %}

{% set showStickyNavscripts = true %}
{% set listItems = [
    { text: 'Case for support', url: '#case', class:'canScroll' },
    { text: 'Capability to deliver', url: '#capability', class:'canScroll' },
    { text: 'Pathways to impact', url: '#pathways', class:'canScroll' },
    { text: 'Data impact statement', url: '#data', class:'canScroll' },
    { text: 'Finances', url: '#finances', class:'canScroll' },
    { text: 'Letters of support', url: '#letters', class:'canScroll' }
] %}

{% set review = review if review %}
{% set rating = rating if rating %}
{% set thisReviewValue = thisReviewValue if thisReviewValue %}

{% block content %}

    {% call components.bulmaRow() %}

        {% call components.bulmaColumnAny(size='is-full') %}

            {#{{ components.alerts(text='You must confirm that you are eligible to review this application', type='info')}}#}
            <div class="govuk-notification-banner govuk-notification-banner--success" role="region" aria-labelledby="govuk-notification-banner-title" data-module="govuk-notification-banner">
                <div class="govuk-notification-banner__header">
                    <h2 class="govuk-notification-banner__title" id="govuk-notification-banner-title">Complete</h2>
                </div>
                <div class="govuk-notification-banner__content">
                    <p class="govuk-notification-banner__heading">
                        Review complete, submitted on {{ 'dataAndTime' | dateAndTime() }}
                    </p>
                </div>
            </div>

        {%- endcall %}

    {%- endcall %}

    {% call components.bulmaRow() %}

        {% call components.bulmaColumnAny(size='is-full', customID='main-content') %}

            <p class="govuk-body">
                <strong>Review deadline:</strong> 14 May 2021<br>
            </p>
        {%- endcall %}
    {%- endcall %}

    <section class="section" id="main-content">

        {% call components.bulmaRow() %}

            {% call components.bulmaColumnAny(size='column is-full') %}
                <div class="govuk-tabs" data-module="govuk-tabs">
                    <h2 class="govuk-tabs__title">
                        Contents
                    </h2>
                    <ul class="govuk-tabs__list">
                        <li class="govuk-tabs__list-item ">
                            <a class="govuk-tabs__tab" href="#overview">
                                Application overview
                            </a>
                        </li>
                        <li class="govuk-tabs__list-item">
                            <a class="govuk-tabs__tab" href="#read">
                                Read application
                            </a>
                        </li>
                        <li class="govuk-tabs__list-item govuk-tabs__list-item--selected">
                            <a class="govuk-tabs__tab" href="#write">
                                Your review
                            </a>
                        </li>
                    </ul>
                    <style>
                        .govuk-tabs__panel {
                            border-left:0!important;
                            border-right:0!important;
                            border-bottom:0!important;
                            padding-left:0!important;
                            padding-right:0!important;
                        }
                    </style>
                    <div class="govuk-tabs__panel" id="overview">

                        {% call components.bulmaRow() %}

                            {% call components.bulmaColumnAny(size='is-8', extraClass='') %}

                                {{ components.captionHeading(text='Review deadline',tag='h2', size='s') }}

                                <p class="govuk-body">
                                    14 May 2021
                                </p>

                                {{ components.captionHeading(text='Opportunity',tag='h2', size='s') }}

                                <p class="govuk-body">
                                    <a href="#">Development of a Novel Inhibitor of Ricin</a>
                                </p>

                                {{ components.captionHeading(text='Application title',tag='h2', size='s') }}

                                <p class="govuk-body">
                                    Bio-detoxification of Ricin in castor bean
                                </p>

                                {{ components.captionHeading(text='Team',tag='h2', size='s') }}

                                <p class="govuk-body">
                                    <strong>Principal investigator:</strong> Prof Giles Dexter, Coventry University<br>
                                    <strong>Co-investigator:</strong> Prof Ian Charles,  Coventry University<br>
                                    <strong>Researcher:</strong> Dr Maxwell Peterson,  Coventry University<br>
                                </p>

                                {{ components.captionHeading(text='Grant size',tag='h2', size='s') }}

                                <p class="govuk-body">
                                    Â£80,000
                                </p>

                                {{ components.captionHeading(text='Summary',tag='h2', size='s') }}

                                <p class="govuk-body">
                                    The PI proposes a high-impact collaborative research project to develop new inhibitors for ribosome inactivating proteins (RIPs), such as ricin and Shiga toxin. Ricin toxin, produced by the castor bean plant, has a nefarious past. Ricin is a well-known homicidal poison and has been used in several bioterrorist attacks. Shiga toxin is a deadly product of enterobacterial Escherichia coli. RIPs are RNA N-glycosidases that enzymatically remove specific purine residues from the universally conserved sarcin/ricin loop (S/R loop) of large ribosomal RNA, causing cellular death.
                                </p>

                                <p class="govuk-body">
                                    Phasellus ac risus lectus. Proin quis vehicula metus. Suspendisse eget odio metus. Maecenas vehicula quam ut accumsan dapibus. Phasellus sit amet nibh a lectus commodo viverra in id risus. Maecenas at sem nec dolor consectetur accumsan. Morbi non eros magna. Sed et mauris libero. Donec sollicitudin, risus non pulvinar consectetur, nibh lacus venenatis nunc, eget laoreet libero quam et lacus. Proin eros tortor, tempor quis dui quis, consequat ultricies arcu. Sed congue turpis at elit posuere, quis iaculis elit consequat. In maximus eu mi id euismod.
                                </p>

                                <p class="govuk-body u-space-t45">
                                    <a href="/prototypes/peer-review-external/invite-reject" class="govuk-link">Unable to review this application?</a>
                                </p>


                            {%- endcall %}

                        {%- endcall %}

                    </div>
                    {#


                            END TAB ONE


                    #}

                    <div class="govuk-tabs__panel govuk-tabs__panel--hidden" id="read">

                        {% call components.bulmaRow() %}

                            {% call components.bulmaColumnAny(size='is-3') %}
                                <nav class="sticky-nav">
                                    {{ components.linkHeading(text='Contents', tag='h2', size='s')}}
                                    {{ components.list(items=listItems, parentClass='sticky-nav')}}
                                </nav>
                            {%- endcall %}

                            {% call components.bulmaColumnAny(size='is-7', extraClass='{#u-space-t20#}') %}


                                {% include '../generic-includes/review-content.njk' %}

                                <p class="govuk-body u-space-t45">
                                    <a href="/prototypes/peer-review-external/invite-reject" class="govuk-link">Unable to review this application?</a>
                                </p>

                            {%- endcall %}

                        {%- endcall %}
                    </div>
                    {#


                            END TAB TWO


                    #}
                    <div class="govuk-tabs__panel govuk-tabs__panel--hidden" id="write">

                        {% call components.bulmaRow() %}

                            {% call components.bulmaColumnAny(size='is-8', extraClass='') %}

                                {{ components.captionHeading(text='Your review',tag='h2', size='m') }}

                                <div class="tiny-spoof u-space-b30">
                                    {{ review }}
                                </div>

                                <h2 class="govuk-heading-m">Your review score</h2>

                                <p class="govuk-body">
                                    {{ rating }} - {{ thisReviewValue }}
                                </p>


                            {%- endcall %}

                        {%- endcall %}


                        {% call components.form(action='#', method='POST',name='formReview') %}


                            {% call components.bulmaRow() %}

                                {% call components.bulmaColumnAny(size='is-8 ', extraClass='{#u-space-t20#}') %}


                                {%- endcall %}



                            {%- endcall %}





                        {%- endcall %}




                    </div>
                    {#



                            END TAB THREE



                    #}

                </div>
            {%- endcall %}

        {%- endcall %}
    </section>

    {% include '../../layouts/partials/user-contact.njk' %}

{% endblock %}

{% block bodyScripts %}
    {#<script>
    </script>#}
    <script type="text/javascript">
        /* smooth-scroll.js v1.3.1 */
        /*
        n=0,
        r=500,
        i=15,
        */
        (function(e,t){
            "use strict";
            var n=0,
                r=250,
                i=15,
                /*s=document.getElementsByTagName("a"),*/
                s=document.getElementsByClassName('canScroll'),
                o;
            for(var u=0;u<s.length;u++){
                o=s[u].attributes.href===t?null:s[u].attributes.href.nodeValue.toString();
                if(o!==null&&o.length>1&&o.indexOf("#")!=-1){
                    s[u].onclick=function(){
                        var n,s=this.attributes.href.nodeValue.toString(),o=s.substr(0,s.indexOf("#")),u=s.substr(s.indexOf("#")+1);if(n=document.getElementById(u)){var l=(r-r%i)/i,c=f(),h=(a(n)-c)/l;if(e.history&&typeof e.history.pushState=="function")e.history.pushState({},t,o+"#"+u);for(var p=1;p<=l;p++){(function(){var t=h*p;setTimeout(function(){e.scrollTo(0,t+c)},i*p)})()}return false}}}}var a=function(e){var r=n*-1;while(e.offsetParent!=t&&e.offsetParent!=null){r+=e.offsetTop+(e.clientTop!=null?e.clientTop:0);e=e.offsetParent}return r};var f=function(){return e.pageYOffset!==t?e.pageYOffset:document.documentElement.scrollTop!==t?document.documentElement.scrollTop:document.body.scrollTop}})(window)
    </script>

    <script src="https://cdn.tiny.cloud/1/phk3goz7y02jvj65em0m21azcq1qr7abduimch9isoe4jkor/tinymce/5/tinymce.min.js" referrerpolicy="origin"></script>

    <script>
        /*
      tinyMCE.init({
          setup: function(editor) {
              editor.on("init", function(){
              editor.addShortcut("ctrl+u", "", "");
          });
          }
      })
      oninit : "disableShortcuts",
          setup: function(editor) {
            editor.on('init', function(){
              editor.addShortcut('Command+I', '', '');
            });
          },

      */

        tinymce.init({
            selector: '#tinyMCEInput',
            height: 500,
            plugins: [
                'advlist autolink lists link anchor',
                'wordcount'
            ],
            content_style: '.red-text {color: red}',
            formats :{
                //redText: { selector: 'p', classes: 'red-text' },
                redText: { inline: 'span', classes: 'red-text' },
                para: { selector: 'p,h2,h3,h4,li', classes: 'govuk-body' },
                heading2: { selector: 'p,h2,h3,h4,li', classes: 'govuk-heading-l', exact: true },
                heading3: { selector: 'p,h2,h3,h4', classes: 'govuk-heading-m', exact: true },
                heading4: { selector: 'p,h2,h3,h4', classes: 'govuk-heading-s', exact: true },
                unorderedList: { selector: 'ul, ol, p,h2,h3,h4', classes: 'govuk-list govuk-list--bullets'},
            },
            style_formats: [
                /*{title: 'Red text', format: 'redText', styles: { color: '#ff0000' }},*/
                {title: 'Paragraph', format: 'para'},
                /*{title: 'Heading 2', format: 'heading2', block: 'h2', /!*styles: { color: 'lime' },*!/ classes: 'govuk-heading-l'},*/
                {title: 'Heading 2', format: 'heading2', remove: 'all', block: 'h2', classes: 'govuk-heading-l'},
                {title: 'Heading 3', format: 'heading3', block: 'h3', classes: 'govuk-heading-m'},
                {title: 'Heading 4', format: 'heading4', block: 'h4', classes: 'govuk-heading-s'},
                {title: 'Unordered list', format: 'unorderedList', block: 'ul'},
            ],
            advlist_bullet_styles: 'disc',
            advlist_number_styles: 'default',
            // toolbar: 'formatselect | bold italic | bullist numlist | align | indent outdent | link',
            // toolbar: 'formatselect | bold | bullist numlist | link',
            content_css: [
                '//fonts.googleapis.com/css?family=Open+Sans:400,400i,700,700i',
                '/stylesheets/tinymce.css'
            ],
            menubar: false,
        });
    </script>
    <script>
        ;(function(){
            let wordcounter = document.getElementById('codeOutput');
            let counteroutputFoot = document.getElementById('wordCount2');
            let words;
            const limit = 50;
            function countemwords(){
                words = (wordcounter.value == '')? 0 : wordcounter.value.split(' ').length;
                let remainder = limit - words;
                counteroutputFoot.innerHTML = 'You have ' + words + ' words';
            }
            wordcounter.addEventListener('input', function(e){
                countemwords()
            }, false);
            document.addEventListener("DOMContentLoaded", function(event) {
                countemwords()
            }, false);
            window.addEventListener("load", function(event) {
                countemwords();
            }, false)
        })();
    </script>
{% endblock %}
