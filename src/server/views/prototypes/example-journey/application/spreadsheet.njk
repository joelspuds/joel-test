
{% set isAdminUser = false %}
{%  set loggedOut = false %}

{% extends 'layouts/bulma-ufs.layout.njk' %}

{% set pageTitle = '171 - Development of a Novel Inhibitor of Ricin' %}
{#{% set showSpreadsheetscripts = true %}#}
{% set speakerNotes = speakerNotes if speakerNotes %}

{% block content %}


    {% call components.bulmaRow() %}
        {% call components.bulmaColumnAny(size='is-two-thirds') %}
            {{ components.captionHeading(text='Spreadsheet example') }}
        {%- endcall %}
    {%- endcall %}



<section class="section" id="mainContent">

    {% call components.bulmaRow() %}

        {% call components.bulmaColumnAny(size='column is-9-desktop is-9-widescreen') %}
            {{ components.paragraph(text='Enter your financial data into the spreadsheet below. You can cut and paste directly from an Excel spreadsheet', size='l')}}

            <p class="govuk-body">
                {{ components.link(text='Download example spreadhseet', url='/files/example_spreadsheeet.xls')}}
            </p>

            {{ components.paragraph(text='Select the required cells in Excel and paste into the "spreadsheet" below, then click the <strong>Preview data</strong> button. Contents will be displayed in a JavaScript alert dialogue or open the console (Right click > inspect) to view the captured data as a big array. This data is VERY EASY to send off to a the server as JSON or a CSV and manipulate programatically.')}}

        {%- endcall %}

    {%- endcall %}

    {% call components.bulmaRow() %}

        {% call components.bulmaColumnAny(size='column is-full {#is-9-desktop is-9-widescreen#}') %}

            {% call components.form(action='/prototypes/example-journey/application/spreadsheet', method='POST',name='formSpreadsheet') %}

                              <div id="financialData"></div>

                <div class="application-controls govuk-clearfix u-space-t45">

                    <button type="submit" id="saveTableData" class="govuk-button application-controls__submit">Preview data</button>

                </div>

            {%- endcall %}

        {%- endcall %}

    {%- endcall %}

</section>

{% endblock %}


{% block bodyScripts %}
    <link href="https://cdn.jsdelivr.net/npm/handsontable/dist/handsontable.full.min.css" media="all" rel="stylesheet">
    <script src='https://cdn.jsdelivr.net/npm/handsontable/dist/handsontable.full.min.js'></script>
    <script>
        var ready = (callback) => {
            if (document.readyState != 'loading') callback();
            else document.addEventListener('DOMContentLoaded', callback);
        }
        ready(() => {

            let data = [
                ['', '', '', '', '', '', '', '', '', '', '', ''],
                ['', '', '', '', '', '', '', '', '', '', '', ''],
                ['', '', '', '', '', '', '', '', '', '', '', ''],
                ['', '', '', '', '', '', '', '', '', '', '', '']
            ];

            let container = document.getElementById('financialData');
            let hot = new Handsontable(container, {
                data: data,
                rowHeaders: true,
                colHeaders: true,
                filters: true,
                dropdownMenu: true,
                licenseKey: 'non-commercial-and-evaluation'
            });

            let saveButton = document.getElementById('saveTableData');
            saveButton.onclick = function(e) {
                e.preventDefault();
                alert('HERE IS YOUR EASILY-DIGESTIBLE CSV DATE:' + '\n' + '\n' + '\n'  + data);
                console.log(data);
            };

        });
    </script>
{% endblock %}





