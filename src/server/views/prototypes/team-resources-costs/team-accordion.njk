{% set showExternalNav = true %}
{% set activeNavItem = 'applications' %}
{% set navArea = 'home' %}
{% set homeLink = '/prototypes/team-resources-costs/home' %}
{% set awardsLink = '#' %}
{% set applicationsLink = '/prototypes/team-resources-costs/applications' %}
{% set awardsLink = '#' %}
{% set reviewsLink = '#' %}
{% set hideAccountLinks = 'true' %}
{% set altProfilePagelink = '#' %}
{% set hideUserMenu = true %}

{% extends 'layouts/bulma-ufs.layout.njk' %}

{% set allData = allData if allData %}
{% set userName = allData.userName if allData.userName else 'Dr. Sheila Banner' %}
{% set prototypeData = prototypeData if prototypeData %}
{% set allTeamMembers = allTeamMembers if allTeamMembers %}

{% set isAdminUser = false %}
{%  set loggedOut = false %}

{% set pageTitle = 'Team ' + GLOBAL_TAG_TITLE_SUFFIX %}
{% set backLinkContents =  [{url:'/prototypes/team-resources-costs/application-overview', text:'Back to application overview'}] %}

{% block content %}

    {% if tempFirstNameNotification %}
        {% call components.bulmaRow() %}
            {% call components.bulmaColumnAny(size='is-full') %}
                <div class="govuk-notification-banner govuk-notification-banner--success" role="region" aria-labelledby="govuk-notification-banner-title" data-module="govuk-notification-banner">
                    <div class="govuk-notification-banner__header">
                        <h2 class="govuk-notification-banner__title" id="govuk-notification-banner-title">Success</h2>
                    </div>
                    <div class="govuk-notification-banner__content">
                        <p class="govuk-notification-banner__heading">You have successfully removed {{ tempFirstNameNotification }} {{ tempLastNameNotification }}</p>
                        {#<p class="govuk-body">By {{ externalAwardPrototypeData.userName }} on behalf University of Wales on {{ 'dataAndTime' | dateAndTime() }}</p>#}
                    </div>
                </div>
            {%- endcall %}
        {%- endcall %}

    {% endif %}


    {% call components.bulmaRow() %}

        {% call components.bulmaColumnAny(size='column is-full is-9-desktop is-9-widescreen') %}

            {{ components.captionHeading(text='Team', caption='APP171: Bio-detoxification of Ricin in castor bean') }}

        {%- endcall %}

    {%- endcall %}

    {% call components.form(action='#', method='POST',name='submitForm') %}

    <section class="section" id="mainContent">

        {% call components.bulmaRow() %}
            {% call components.bulmaColumnAny(size='is-three-quarters', customID='') %}
                    <p class="govuk-body govuk-!-font-size-24">Name all contributors to the proposed work and the amount of time they will spend contributing towards the project.</p>
            {%- endcall %}
        {%- endcall %}

        {% call components.bulmaRow() %}
            {% call components.bulmaColumnAny(size='is-three-quarters', customID='') %}
                {% call components.formGroup() %}
                    {#{{ components.button(text='Add team member', extraClass="govuk-button--secondary govuk-button--link", url='/prototypes/team-resources-costs/add-team-member') }}#}

                    <a class="govuk-button govuk-button--secondary " href="/prototypes/team-resources-costs/select-role-type" role="button">Add team member</a>
                {%- endcall %}
            {%- endcall %}
        {%- endcall %}

        {% call components.bulmaRow() %}
            {% call components.bulmaColumnAny(size='is-full', customID='') %}
                {{ components.captionHeading(text='Directly allocated', tag='h2', size='m') }}
                <div class="responsive-table ">
                    <table class="govuk-table responsive-table__table">
                        <thead>
                            <tr>
                                <th class="govuk-table__header">Name</th>
                                <th class="govuk-table__header">Role</th>
                                <th class="govuk-table__header">Organisation</th>
                                <th class="govuk-table__header govuk-table__header--numeric">Time spent FTE<br>on project (%)</th>
                                <th class="govuk-table__header govuk-table__header--numeric">Average hours per<br>week on project</th>
                                <th class="govuk-table__header govuk-table__header--numeric"><span class="govuk-visually-hidden">Actions</span></th>
                            </tr>
                        </thead>
                        <tbody>
                        {% for item in allTeamMembers2 %}
                            {% if item.isComplete and item.roleType == 'Directly allocated'%}
                            <tr>
                                <td class="govuk-table__cell">
                                    <a href="/prototypes/team-resources-costs/team-member?teamMemberID={{ item.id }}" class="govuk-link">
                                        {% if not item.firstName %}
                                            Unknown
                                        {% else %}
                                            {{ item.firstName }} {{ item.lastName }}
                                        {% endif %}
                                    </a> </td>
                                <td class="govuk-table__cell">
                                    {% if item.role %}
                                        {{ item.role }}
                                    {% else %}
                                        <span class="meta">Not set</span>
                                    {% endif %}
                                </td>
                                <td class="govuk-table__cell">{{ item.organisation }}</td>
                                <td class="govuk-table__cell govuk-table__cell--numeric">
                                    {% if item.timeSpent %}
                                        {{ item.timeSpent }}
                                    {% else %}
                                        <span class="meta">Not set</span>
                                    {% endif %}
                                </td>
                                <td class="govuk-table__cell govuk-table__cell--numeric">
                                    {% if item.averageHours %}
                                        {{ item.averageHours }}
                                    {% else %}
                                        <span class="meta">Not set</span>
                                    {% endif %}
                                </td>
                                <td class=" govuk-table__cell govuk-table__cell--numeric">
                                    {% if item.id == '1' %}
                                        <span class="meta">&mdash;</span>
                                    {% else %}
                                        <a href="/prototypes/team-resources-costs/team?action=remove&teamMemberID={{ item.id }}" class="govuk-link">Remove</a>
                                    {% endif %}
                                </td>

                            </tr>
                            {% endif %}
                        {% endfor %}
                        </tbody>
                    </table>
                </div>
            {%- endcall %}
        {%- endcall %}

        {% if allData.diCount > 0 %}
            {% call components.bulmaRow() %}
                {% call components.bulmaColumnAny(size='is-full', customID='') %}
                    {{ components.captionHeading(text='Directly incurred', tag='h2', size='m') }}
                    <div class="responsive-table ">
                        <table class="govuk-table responsive-table__table">
                            <thead>
                            <tr>
                                <th class="govuk-table__header">Name</th>
                                <th class="govuk-table__header">Role</th>
                                <th class="govuk-table__header">Organisation</th>
                                <th class="govuk-table__header govuk-table__header--numeric">Time spent FTE<br>on project (%)</th>
                                <th class="govuk-table__header govuk-table__header--numeric">Average hours per<br>week on project</th>
                                <th class="govuk-table__header govuk-table__header--numeric">Start<br>date</th>
                                <th class="govuk-table__header govuk-table__header--numeric">End<br>date</th>
                                <th class="govuk-table__header govuk-table__header--numeric"><span class="govuk-visually-hidden">Actions</span></th>
                            </tr>
                            </thead>
                            <tbody>
                            {% for item in allTeamMembers2 %}
                                {% if item.isComplete and item.roleType == 'Directly incurred'%}
                                    <tr>
                                        <td class="govuk-table__cell"><a href="/prototypes/team-resources-costs/team-member?teamMemberID={{ item.id }}" class="govuk-link">{% if not item.firstName %}Unknown {% else %} {{ item.firstName }} {{ item.lastName }} {% endif %}</a> </td>
                                        <td class="govuk-table__cell">
                                            {% if item.role %} {{ item.role }} {% else %} <span class="meta">Not set</span>>  {% endif %}
                                        </td>
                                        <td class="govuk-table__cell">{{ item.organisation }}</td>
                                        <td class="govuk-table__cell govuk-table__cell--numeric">{% if item.timeSpent %} {{ item.timeSpent }} {% else %} <span class="meta">Not set</span>  {% endif %}</td>
                                        <td class="govuk-table__cell govuk-table__cell--numeric">{% if item.averageHours %} {{ item.averageHours }} {% else %} <span class="meta">Not set</span>  {% endif %}</td>
                                        <td class=" govuk-table__cell govuk-table__cell--numeric">{{ item.startDay }} {{ item.startMonth | showMonth() }} {{ item.startYear }}</td>
                                        <td class=" govuk-table__cell govuk-table__cell--numeric">{{ item.endDay }} {{ item.endMonth | showMonth() }} {{ item.endYear }}</td>
                                        <td class=" govuk-table__cell govuk-table__cell--numeric"><a href="/prototypes/team-resources-costs/team?action=remove&teamMemberID={{ item.id }}" class="govuk-link">Remove</a></td>
                                    </tr>
                                {% endif %}
                            {% endfor %}
                            </tbody>
                        </table>
                    </div>
                {%- endcall %}
            {%- endcall %}
        {% endif %}

        {% if allData.exCount > 0 %}
            {% call components.bulmaRow() %}
                {% call components.bulmaColumnAny(size='is-full', customID='') %}
                    {{ components.captionHeading(text='Exception', tag='h2', size='m') }}
                    <div class="responsive-table ">
                        <table class="govuk-table responsive-table__table">
                            <thead>
                            <tr>
                                <th class="govuk-table__header">Name</th>
                                <th class="govuk-table__header">Role</th>
                                <th class="govuk-table__header">Organisation</th>
                                <th class="govuk-table__header govuk-table__header--numeric">Time spent FTE<br>on project (%)</th>
                                <th class="govuk-table__header govuk-table__header--numeric">Average hours per<br>week on project</th>
                                <th class="govuk-table__header govuk-table__header--numeric">Start<br>date</th>
                                <th class="govuk-table__header govuk-table__header--numeric">End<br>date</th>
                                <th class="govuk-table__header govuk-table__header--numeric"><span class="govuk-visually-hidden">Actions</span></th>
                            </tr>
                            </thead>
                            <tbody>
                            {% for item in allTeamMembers2 %}
                                {% if item.isComplete and item.roleType == 'Exception'%}
                                    <tr>
                                        <td class="govuk-table__cell"><a href="/prototypes/team-resources-costs/team-member?teamMemberID={{ item.id }}" class="govuk-link">{% if not item.firstName %}Unknown {% else %} {{ item.firstName }} {{ item.lastName }} {% endif %}</a> </td>
                                        <td class="govuk-table__cell">
                                            {% if item.role %} {{ item.role }} {% else %} <a href="/prototypes/team-resources-costs/select-role?teamMemberID={{ item.id }}" class="govuk-link">Select</a>  {% endif %}
                                        </td>
                                        <td class="govuk-table__cell">{{ item.organisation }}</td>
                                        <td class="govuk-table__cell govuk-table__cell--numeric">{% if item.timeSpent %} {{ item.timeSpent }} {% else %} <span class="meta">Not set</span>  {% endif %}</td>
                                        <td class="govuk-table__cell govuk-table__cell--numeric">{% if item.averageHours %} {{ item.averageHours }} {% else %} <span class="meta">Not set</span>  {% endif %}</td>
                                        <td class=" govuk-table__cell govuk-table__cell--numeric">{{ item.startDay }} {{ item.startMonth | showMonth() }} {{ item.startYear }}</td>
                                        <td class=" govuk-table__cell govuk-table__cell--numeric">{{ item.endDay }} {{ item.endMonth | showMonth() }} {{ item.endYear }}</td>
                                        <td class=" govuk-table__cell govuk-table__cell--numeric"><a href="/prototypes/team-resources-costs/team?action=remove&teamMemberID={{ item.id }}" class="govuk-link">Remove</a></td>

                                    </tr>
                                {% endif %}
                            {% endfor %}
                            </tbody>
                        </table>
                    </div>
                {%- endcall %}
            {%- endcall %}
        {% endif %}




        {% call components.bulmaRow() %}
            {% call components.bulmaColumnAny(size='is-three-quarters', customID='') %}

                {% call components.formGroup() %}
                    <div class="application-item">
                        <div class="application-item__contents application-item__contents--mac">
                            <fieldset class="govuk-fieldset" aria-describedby="markAsComplete">
                                <legend class="govuk-fieldset__legend govuk-visually-hidden">
                                    <h3 class="govuk-fieldset__heading" id="">Mark as complete</h3>
                                </legend>
                                <div class="govuk-checkboxes">
                                    <div class="govuk-checkboxes__item">
                                        <input class="govuk-checkboxes__input" id="markAsComplete" name="isComplete" type="checkbox" {% if allData.teamMarkAsComplete %} checked{% endif %}>
                                        <label class="govuk-label govuk-checkboxes__label" for="markAsComplete">Mark as complete</label>
                                    </div>
                                </div>
                            </fieldset>
                        </div>
                    </div>
                {%- endcall %}

                {% call components.formGroup() %}
                    <div class="application-controls govuk-clearfix">
                        {{ components.button(text='Save and continue', extraClass="application-controls__submit")}}
                    </div>
                {%- endcall %}
            {%- endcall %}
        {%- endcall %}

    </section>

    {%- endcall %}

    {% include '../../layouts/partials/user-contact.njk' %}

{% endblock %}

{% block bodyScripts %}
    {#<script>
    </script>#}
{% endblock %}
